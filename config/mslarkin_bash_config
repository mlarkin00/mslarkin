#!/bin/bash

#####
# Add this command to the end of .bashrc 
# source ~/msl-playground/config/mslarkin_bash_config
# .bashrc runs every time the terminal is opened
#####

echo "Running mslarkin_bash_config (new shell)"

################
# Install Docker
################
if [ ! -f /usr/bin/docker ]; then
    echo "Docker not found, installing..."
    bash <(curl -s https://get.docker.com)
fi
################
# Install Hey
################
if [ ! -d "$HOME/local_tools" ]; then
    mkdir -p ~/local_tools
    export PATH=$PATH:/usr/local/go/bin:/home/matthewlarkin/go/bin:/home/matthewlarkin/local_tools
fi
if [ ! -f ~/local_tools/hey_linux_amd64 ]; then
    echo "Hey not found, installing..."
    curl https://hey-release.s3.us-east-2.amazonaws.com/hey_linux_amd64 --output ~/local_tools/hey_linux_amd64
    chmod +x ~/local_tools/hey_linux_amd64
fi
alias hey='~/local_tools/hey_linux_amd64'

################
# Install Node Version Manager (NVM) & Node.js
################
if [ ! -d "$HOME/.config/nvm" ]; then
    echo "NVM not found, installing..."
    curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash
    nvm install --lts
fi

################
# Set up GCP Project environment
################
gcloud config set core/user_output_enabled False
if [[ "$(gcloud config list project | grep project)" == *"(unset)"* ]]; then
  gcloud config set project mslarkin-ext 
fi
gcloud config set run/region us-west1 
gcloud config set account matthewlarkin@google.com 
gcloud config set builds/region us-west1 
gcloud config set compute/region us-west1 

gcloud config unset core/user_output_enabled

gcloud config list

# Set Gemini API key
export GEMINI_API_KEY="AIzaSyAQzwmAMXAJV6eKZMaeYhLjLAGN-HFg4Ho"

################
# Set up useful aliases
################
alias gcurl='curl --header "Authorization: Bearer $(gcloud auth print-access-token)"'
# alias gcurl_id='curl --header "Authorization: Bearer $(gcloud auth print-identity-token)"'
alias refreshauth='GOPROXY=proxy.golang.org go run github.com/GoogleCloudPlatform/artifact-registry-go-tools/cmd/auth@v0.1.0 refresh'
alias gemini='npx @gemini-cli/cli@dogfood'